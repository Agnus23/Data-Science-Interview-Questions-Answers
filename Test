SELECT 
    s.name AS SchemaName,
    t.name AS TableName,
    c.name AS ColumnName,
    tp.name AS DataType,
    c.max_length AS MaxLength,
    c.precision AS Precision,
    c.scale AS Scale,
    c.is_nullable AS IsNullable,
    CASE 
        WHEN pk.column_id IS NOT NULL THEN 'YES'
        ELSE 'NO'
    END AS IsPrimaryKey
FROM 
    sys.tables t
INNER JOIN 
    sys.schemas s ON t.schema_id = s.schema_id
INNER JOIN 
    sys.columns c ON t.object_id = c.object_id
INNER JOIN 
    sys.types tp ON c.user_type_id = tp.user_type_id
LEFT JOIN 
    sys.index_columns ic ON c.object_id = ic.object_id AND c.column_id = ic.column_id
LEFT JOIN 
    sys.indexes i ON t.object_id = i.object_id AND i.is_primary_key = 1 AND ic.index_id = i.index_id
LEFT JOIN 
    (SELECT kcu.TABLE_NAME, kcu.COLUMN_NAME, kcu.CONSTRAINT_NAME, kc.type
     FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE kcu
     JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS kc ON kcu.CONSTRAINT_NAME = kc.CONSTRAINT_NAME
     WHERE kc.CONSTRAINT_TYPE = 'PRIMARY KEY') pk
     ON c.name = pk.COLUMN_NAME AND t.name = pk.TABLE_NAME
ORDER BY 
    s.name, t.name, c.column_id;
